>>> import arara.model
>>> arara.model.init_test_database()
>>> import arara
>>> server = arara.get_namespace()

# Login as SYSOP and create 'garbage' board

>>> ret, session_key_sysop = server.login_manager.login(u'SYSOP', u'SYSOP', u'123.123.123.123')
>>> ret
True

>>> server.board_manager.add_board(unicode(session_key_sysop), u'garbages', u'Garbage Board')
(True, 'OK')

# Register one user, mikkang
>>> user_reg_dic = {'username':u'mikkang', 'password':u'mikkang', 'nickname':u'mikkang', 'email':u'mikkang', 'signature':u'mikkang', 'self_introduction':u'mikkang', 'default_language':u'english' }
>>> ret, register_key = server.member_manager.register(user_reg_dic)
>>> ret
True
>>> server.member_manager.confirm(u'mikkang', unicode(register_key))
(True, 'OK')
>>> ret, session_key = server.login_manager.login(u'mikkang', u'mikkang', u'143.248.234.140')
>>> ret
True

# Faking time.time (to check time field)

>>> import time
>>> def stub_time():
...     return 1.1
>>> org_time = time.time
>>> time.time = stub_time

# Testing File Manager!

>>> server.article_manager.board_list(session_key)
(True, [{'read_only': False, 'board_name': u'garbages', 'board_description': u'Garbage Board'}])

# Write an article

>>> article_dic = {'title': u'serialx is...', 'content': u'polarbear'}
>>> server.article_manager.write_article(session_key, u'garbages', article_dic)
(True, 1)

# Read the article

>>> server.article_manager.read(session_key, u'garbages', 1)
(True, [{'author_username': u'mikkang', 'hit': 1, 'blacklisted': False, 'root_id': 1, 'deleted': False, 'last_modified_date': datetime.datetime(1970, 1, 1, 9, 0, 1, 100000), 'is_searchable': True, 'author_nickname': u'mikkang', 'content': u'polarbear', 'vote': 0, 'depth': 1, 'date': datetime.datetime(1970, 1, 1, 9, 0, 1, 100000), 'title': u'serialx is...', 'id': 1}])

>>> article_id = 1
>>> server.file_manager.save_file(session_key, article_id , u'hahahah.jpg')
(True, u'garbages/1970/1/1', u'a99c6ec38a09c884d8ae2ae04ebaf652')

>>> time.time = org_time

>>> server.file_manager.download_file(session_key, article_id , 1)
(True, u'garbages/1970/1/1', u'a99c6ec38a09c884d8ae2ae04ebaf652')

>>> server.file_manager.delete_file(session_key, article_id , 1)
(True, u'garbages/1970/1/1', u'a99c6ec38a09c884d8ae2ae04ebaf652')
